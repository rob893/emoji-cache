<?php
class ğŸ¦˜ï¸ğŸ¦˜ï¸ğŸ¦˜ï¸
{
    public $ğŸ”‘;

    public $ğŸ¬;

    public ?ğŸ¦˜ï¸ğŸ¦˜ï¸ğŸ¦˜ï¸ $ğŸ‘‰;

    public ?ğŸ¦˜ï¸ğŸ¦˜ï¸ğŸ¦˜ï¸ $ğŸ‘ˆ;

    public function __construct($ğŸ”‘, $ğŸ¬, ?ğŸ¦˜ï¸ğŸ¦˜ï¸ğŸ¦˜ï¸ $ğŸ‘‰ = null, ?ğŸ¦˜ï¸ğŸ¦˜ï¸ğŸ¦˜ï¸ $ğŸ‘ˆ = null)
    {
        $this->ğŸ”‘ = $ğŸ”‘;
        $this->ğŸ¬ = $ğŸ¬;
        $this->ğŸ‘‰ = $ğŸ‘‰;
        $this->ğŸ‘ˆ = $ğŸ‘ˆ;
    }
}

class ğŸ†ğŸ†ğŸ†
{
    private int $ğŸ¦•;

    private array $ğŸŒ‹ = [];

    private ?ğŸ¦˜ï¸ğŸ¦˜ï¸ğŸ¦˜ï¸ $ğŸ—¿ = null;

    private ?ğŸ¦˜ï¸ğŸ¦˜ï¸ğŸ¦˜ï¸ $ğŸ¦¶ï¸ = null;

    public function __construct(int $ğŸ¦• = 250)
    {
        $this->ğŸ¦• = $ğŸ¦•;
    }

    public function ğŸ¤”ğŸ¤”ğŸ¤”($ğŸ”‘): bool
    {
        return array_key_exists($ğŸ”‘, $this->ğŸŒ‹);
    }

    public function âœï¸âœï¸âœï¸($ğŸ”‘, $ğŸ¬): ğŸ†ğŸ†ğŸ†
    {
        if ($this->ğŸ¤”ğŸ¤”ğŸ¤”($ğŸ”‘)) {
            $ğŸ¦ = $this->ğŸŒ‹[$ğŸ”‘];
            $this->âŒğŸ™ğŸŒ‹($ğŸ¦);
        }

        $ğŸ¦›ï¸ = new ğŸ¦˜ï¸ğŸ¦˜ï¸ğŸ¦˜ï¸($ğŸ”‘, $ğŸ¬);
        $this->âœï¸ğŸ¦˜ï¸ğŸ—¿($ğŸ¦›ï¸);
        $this->ğŸŒ‹[$ğŸ”‘] = $ğŸ¦›ï¸;

        $this->âš–ï¸âš–ï¸âš–ï¸();

        return $this;
    }

    public function ğŸ¤”ğŸ¤ğŸ˜ƒ($ğŸ”‘)
    {
        if (!$this->ğŸ¤”ğŸ¤”ğŸ¤”($ğŸ”‘)) {
            return null;
        }

        $â˜„ï¸ = $this->ğŸŒ‹[$ğŸ”‘];
        $this->âœï¸ğŸ¦˜ï¸ğŸ—¿($â˜„ï¸);

        return $â˜„ï¸->ğŸ¬;
    }


    public function âŒâŒâŒ(): void
    {
        $this->ğŸ—¿ = null;
        $this->ğŸ¦¶ï¸ = null;
        $this->ğŸŒ‹ = [];
    }

    public function ğŸ‘™ğŸ’©ğŸ–‡(): int
    {
        return count($this->ğŸŒ‹);
    }

    private function âš–ï¸âš–ï¸âš–ï¸(): void
    {
        $ğŸ’‹ = $this->ğŸ¦¶ï¸;

        while ($ğŸ’‹ !== null && $this->ğŸ‘™ğŸ’©ğŸ–‡() > $this->ğŸ¦•) {
            $ğŸª… = $ğŸ’‹->ğŸ‘ˆ;
            $this->âŒğŸ™ğŸŒ‹($ğŸ’‹);
            $ğŸ’‹ = $ğŸª…;
        }
    }

    private function âœï¸ğŸ¦˜ï¸ğŸ—¿(ğŸ¦˜ï¸ğŸ¦˜ï¸ğŸ¦˜ï¸ $ğŸ¦€): void
    {
        $this->âŒğŸ¦€ğŸ—¿($ğŸ¦€);

        if ($this->ğŸ—¿ === null) {
            $this->ğŸ—¿ = $ğŸ¦€;
            $this->ğŸ¦¶ï¸ = $ğŸ¦€;
        } else {
            $ğŸ¦€->ğŸ‘‰ = $this->ğŸ—¿;
            $this->ğŸ—¿->ğŸ‘ˆ = $ğŸ¦€;
            $this->ğŸ—¿ = $ğŸ¦€;
        }
    }

    private function âŒğŸ¦€ğŸ—¿(ğŸ¦˜ï¸ğŸ¦˜ï¸ğŸ¦˜ï¸ $ğŸ¦€): void
    {
        if ($ğŸ¦€->ğŸ‘ˆ !== null) {
            $ğŸ¦€->ğŸ‘ˆ->ğŸ‘‰ = $ğŸ¦€->ğŸ‘‰;
        }

        if ($ğŸ¦€->ğŸ‘‰ !== null) {
            $ğŸ¦€->ğŸ‘‰->ğŸ‘ˆ = $ğŸ¦€->ğŸ‘ˆ;
        }

        if ($this->ğŸ—¿ === $ğŸ¦€) {
            $this->ğŸ—¿ = $ğŸ¦€->ğŸ‘‰;
        }

        if ($this->ğŸ¦¶ï¸ === $ğŸ¦€) {
            $this->ğŸ¦¶ï¸ = $ğŸ¦€->ğŸ‘ˆ;
        }

        $ğŸ¦€->ğŸ‘‰ = null;
        $ğŸ¦€->ğŸ‘ˆ = null;
    }

    private function âŒğŸ™ğŸŒ‹(ğŸ¦˜ï¸ğŸ¦˜ï¸ğŸ¦˜ï¸ $ğŸ™): bool
    {
        $this->âŒğŸ¦€ğŸ—¿($ğŸ™);

        if ($this->ğŸ¤”ğŸ¤”ğŸ¤”($ğŸ™)) {
            unset($this->ğŸŒ‹[$ğŸ™]);
            return true;
        }

        return false;
    }
}
